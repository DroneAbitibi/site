<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title>Drone Abitibi – Démonstration de couches</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Leaflet CSS -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  >

  <style>
    :root {
      --bg1:#0f1c0f;
      --bg2:#263321;
      --text:#f5f7f5;
      --muted:#dfe6de;
      --accent:#a9c48a;
      --panel:#1b2618;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top left, var(--bg2), var(--bg1));
      color: var(--text);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .page {
      max-width: 1200px;
      margin: 0 auto;
      padding: 1.5rem;
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .back {
      color: var(--muted);
      text-decoration: none;
      font-size: 0.9rem;
      opacity: 0.8;
    }

    .back:hover {
      opacity: 1;
      text-decoration: underline;
    }

    .header {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .header h1 {
      margin: 0;
      font-size: 1.6rem;
    }

    .header p {
      margin: 0;
      max-width: 800px;
      color: var(--muted);
      font-size: 0.95rem;
    }

    .content {
      display: grid;
      grid-template-columns: minmax(0, 2fr) minmax(260px, 1fr);
      gap: 1rem;
      align-items: start;
    }

    #map {
      width: 100%;
      height: 520px;
      border-radius: 0.75rem;
      overflow: hidden;
      box-shadow: 0 18px 45px rgba(0,0,0,0.5);
      border: 1px solid rgba(255,255,255,0.08);
    }

    .side-panel {
      background: linear-gradient(135deg, var(--panel), #10170f);
      border-radius: 0.75rem;
      padding: 1rem 1.2rem;
      border: 1px solid rgba(255,255,255,0.08);
      box-shadow: 0 14px 35px rgba(0,0,0,0.55);
      font-size: 0.9rem;
    }

    .side-panel h2 {
      margin-top: 0;
      font-size: 1.1rem;
      margin-bottom: 0.5rem;
    }

    .side-panel p {
      margin-top: 0;
      margin-bottom: 0.4rem;
      color: var(--muted);
    }

    .layer-list {
      list-style: none;
      padding-left: 0;
      margin: 0.6rem 0 0;
    }

    .layer-list li {
      margin-bottom: 0.4rem;
    }

    .chip {
      display: inline-block;
      padding: 0.15rem 0.55rem;
      border-radius: 999px;
      font-size: 0.78rem;
      background: rgba(169,196,138,0.12);
      border: 1px solid rgba(169,196,138,0.4);
      color: var(--accent);
      margin-right: 0.35rem;
    }

    .note {
      margin-top: 0.8rem;
      font-size: 0.8rem;
      color: rgba(223,230,222,0.8);
      border-top: 1px solid rgba(255,255,255,0.06);
      padding-top: 0.6rem;
    }

    /* Leaflet UI ajustements */
    .leaflet-control-layers {
      background: rgba(20,25,18,0.92);
      color: var(--text);
      border-radius: 0.5rem;
      border: 1px solid rgba(255,255,255,0.15);
    }

    .leaflet-control-layers-expanded {
      padding: 0.4rem 0.5rem;
    }

    .leaflet-control-layers-separator {
      border-top: 1px solid rgba(255,255,255,0.18);
      margin: 0.25rem 0;
    }

    .info-box {
      background: rgba(20,25,18,0.9);
      padding: 0.45rem 0.65rem;
      border-radius: 0.45rem;
      font-size: 0.8rem;
      line-height: 1.3;
      border: 1px solid rgba(255,255,255,0.16);
    }

    .info-box strong {
      color: var(--accent);
      font-weight: 600;
    }

    @media (max-width: 900px) {
      .content {
        grid-template-columns: minmax(0, 1fr);
      }
      #map {
        height: 420px;
      }
    }

    @media (max-width: 600px) {
      .page {
        padding: 1rem;
      }
      #map {
        height: 360px;
      }
    }
  </style>
</head>
<body>
  <div class="page">
    <a href="index.html" class="back">← Retour à l'accueil</a>

    <header class="header">
      <h1>Démonstration de couches cartographiques</h1>
      <p>
        Cette carte interactive présente un exemple d’orthophoto combinée à différentes
        couches dérivées : modèle numérique de terrain (DTM), modèle numérique de
        surface (DSM) et courbes de niveau. Utilisez le bouton de couches dans la carte
        pour activer ou désactiver les différents calques.
      </p>
    </header>

    <div class="content">
      <!-- Carte -->
      <div id="map"></div>

      <!-- Panneau explicatif -->
      <aside class="side-panel">
        <h2>Couches disponibles</h2>
        <p>Chaque couche illustre un aspect différent de la même zone :</p>
        <ul class="layer-list">
          <li>
            <span class="chip">Base</span>
            <strong>Orthophoto</strong> – mosaïque d’images aériennes géoréférencées.
          </li>
          <li>
            <span class="chip">DTM</span>
            <strong>Modèle numérique de terrain</strong> – altitude du sol nu (végétation et bâtiments retirés).
          </li>
          <li>
            <span class="chip">DSM</span>
            <strong>Modèle numérique de surface</strong> – altitude incluant bâtiments, arbres, structures.
          </li>
          <li>
            <span class="chip">Courbes</span>
            <strong>Courbes de niveau</strong> – lignes d’élévation permettant de lire rapidement le relief.
          </li>
        </ul>

        <p class="note">
          Cette page est fournie à titre de démonstration. Les couches et résolutions
          peuvent être adaptées selon les besoins d’un projet précis (survol, volume,
          suivi de chantier, etc.).
        </p>
      </aside>
    </div>
  </div>

  <!-- Leaflet JS -->
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin="">
  </script>

  <script>
    // --- Initialisation de la carte ---
    // Centre approximatif (à adapter à ta zone de démonstration)
    var map = L.map('map', {
      center: [48.23, -79.02], // Ex.: Rouyn-Noranda
      zoom: 14,
      minZoom: 10,
      maxZoom: 22
    });

    // --- Couches de base / overlays ---
    // 1) Orthophoto (base)
    // Remplace l'URL par ton serveur de tuiles / tiles XYZ
    var orthophoto = L.tileLayer(
      'https://example.com/tiles/orthophoto/{z}/{x}/{y}.png',
      {
        maxZoom: 22,
        attribution: '&copy; Source orthophoto',
        detectRetina: true
      }
    ).addTo(map);

    // 2) DTM (MNT) – souvent visualisé en ombrage (hillshade) ou palette de couleurs
    var dtm = L.tileLayer(
      'https://example.com/tiles/dtm-hillshade/{z}/{x}/{y}.png',
      {
        maxZoom: 22,
        opacity: 0.7,
        attribution: '&copy; Modèle numérique de terrain',
        detectRetina: true
      }
    );

    // 3) DSM – modèle numérique de surface
    var dsm = L.tileLayer(
      'https://example.com/tiles/dsm-hillshade/{z}/{x}/{y}.png',
      {
        maxZoom: 22,
        opacity: 0.6,
        attribution: '&copy; Modèle numérique de surface',
        detectRetina: true
      }
    );

    // 4) Courbes de niveau – en tuiles ou WMS
    // Exemple en tuiles PNG (à adapter)
    var contours = L.tileLayer(
      'https://example.com/tiles/contours/{z}/{x}/{y}.png',
      {
        maxZoom: 22,
        opacity: 0.9,
        attribution: '&copy; Courbes de niveau',
        detectRetina: true
      }
    );

    // Si tu as un service WMS pour les courbes, ce serait plutôt:
    /*
    var contours = L.tileLayer.wms('https://example.com/geoserver/wms', {
      layers: 'mon_workspace:contours',
      format: 'image/png',
      transparent: true,
      attribution: '&copy; Courbes de niveau'
    });
    */

    // --- Contrôle de couches ---
    var baseMaps = {
      "Orthophoto": orthophoto
      // Tu pourrais ajouter ici un fond OSM, etc.
    };

    var overlayMaps = {
      "DTM (MNT)": dtm,
      "DSM": dsm,
      "Courbes de niveau": contours
    };

    L.control.layers(baseMaps, overlayMaps, {
      position: 'topright',
      collapsed: false
    }).addTo(map);

    // --- Petit encadré d'information dynamique (optionnel) ---
    var info = L.control({position: 'bottomleft'});

    info.onAdd = function () {
      this._div = L.DomUtil.create('div', 'info-box');
      this.update();
      return this._div;
    };

    info.update = function (zoom) {
      var z = zoom || map.getZoom();
      this._div.innerHTML =
        '<strong>Zoom : </strong>' + z +
        '<br><strong>Coordonnées : </strong><span id="coords">–</span>';
    };

    info.addTo(map);

    // Mise à jour du zoom
    map.on('zoomend', function () {
      info.update(map.getZoom());
    });

    // Affichage des coordonnées sous le curseur
    map.on('mousemove', function (e) {
      var lat = e.latlng.lat.toFixed(6);
      var lng = e.latlng.lng.toFixed(6);
      var coordsSpan = document.getElementById('coords');
      if (coordsSpan) {
        coordsSpan.textContent = lat + ', ' + lng;
      }
    });
  </script>
</body>
</html>